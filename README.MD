# The Eye of Sauron (Telegram Orchestra Parser)

Скрипт находит опрос в теме Telegram-форума, собирает **список проголосовавших** за “позитивные” варианты и отправляет статистику по инструментам в **Избранное**.

Поддерживает:
- Репетиции: варианты с `✅` и/или текстом `приду`
- Концерты: все варианты `Смогу ...` (например: “Смогу к 10”, “Смогу в 13:00”, “Смогу к концерту”)
- Умную сортировку вариантов “Смогу ...” по времени/смыслу (`--smart-sort`)

> Важно: Telegram отдаёт список проголосовавших только для **неанонимных** опросов (public voters).  
> Если опрос анонимный — получить `user_id` голосовавших нельзя.

---

## Установка (Windows / Linux)

```bash
python -m venv .venv
# Windows:
.venv\Scripts\activate
# Linux/macOS:
source .venv/bin/activate

python -m pip install -U pip
python -m pip install -r requirements.txt
```

## Установка (Android / Termux)

```
pkg update && pkg upgrade -y
pkg install -y python

python -m pip install -r requirements.txt
```

# CLI flags (main.py)

## --config <path>
Путь к конфигу (по умолчанию `config.ini`).
Пример:
```
python main.py --config config.ini
```
## --list-topics
Печатает список тем форума (topic) в чате и выходит.
Пример:
```
python main.py --list-topics
```
## --topic-id <id>
Явно задаёт ID темы (topic), в которой искать опрос.
Пример:
```
python main.py --topic-id 4
```
## --topic "<часть названия>"
Ищет тему по части её названия. Если совпадений несколько — предложит выбрать.
Пример:
```
python main.py --topic "концерт"
```
## --poll "<подстрока в вопросе>"
Выбирает опрос по подстроке в тексте вопроса. Если несколько — предложит выбрать.
Если не найдено — берётся самый последний опрос в теме.
Пример:
```
python main.py --topic-id 123 --poll "Бал в Атриуме"
```
## --smart-sort
Умная сортировка позитивных вариантов (в основном для концертов с несколькими “Смогу ...”):
- сначала варианты с распознанным временем (к 10, в 13:00...) по возрастанию
- затем без времени по смыслу: чек/саундчек → репетиция → концерт → прочее
Пример:
```
python main.py --topic "концерт" --poll "Бал в Атриуме" --smart-sort
```